import arcade
import math
import random
import settings


class Chapter1View(arcade.View):
    def on_show(self):
        arcade.set_background_color(arcade.color.WHITE)
        self.player = arcade.Sprite(center_x=100, center_y=100)
        self.player.texture = arcade.make_soft_square_texture(50, arcade.color.BLUE, outer_alpha=255)

        self.zombie_texture = arcade.make_soft_square_texture(50, arcade.color.RED, outer_alpha=255)

        self.zombies = arcade.SpriteList()

        for i in range(5):
            zombie = arcade.Sprite()
            zombie.center_x = random.randrange(0, settings.WIDTH)
            zombie.center_y = random.randrange(settings.HEIGHT // 2, settings.HEIGHT)
            zombie.texture = self.zombie_texture
            self.zombie_x_speed = random.randrange(-5, 5)
            self.zombie_y_speed = random.randrange(-5, 5)
            self.zombies.append(zombie)


    def on_draw(self):
        arcade.start_render()
        # arcade.draw_text("Chapter 1", settings.WIDTH/2, settings.HEIGHT/2,
        #                  arcade.color.BLACK, font_size=30, anchor_x="center")
        self.player.draw()
        self.zombies.draw()


    def update(self, delta_time):
        for zomb in self.zombies:
            zomb.update()
        self.player.update()
        self.player.center_x += self.player.change_x
        self.player.center_y += self.player.change_y


    def on_key_press(self, key, modifiers):
        # self.director.next_view()
        pass

    def on_key_release(self, key, modifiers):
        pass


if __name__ == "__main__":
    """This section of code will allow you to run your View
    independently from the main.py file and its Director.
    You can ignore this whole section. Keep it at the bottom
    of your code.
    It is advised you do not modify it unless you really know
    what you are doing.
    """
    from utils import FakeDirector
    window = arcade.Window(settings.WIDTH, settings.HEIGHT)
    my_view = Chapter1View()
    my_view.director = FakeDirector(close_on_next_view=True)
    window.show_view(my_view)
    arcade.run()
